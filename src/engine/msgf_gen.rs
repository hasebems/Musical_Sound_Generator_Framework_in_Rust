//
//  msgf_gen.rs
//	Musical Sound Generator Framework
//      engine Trait / Tables
//
//  Created by Hasebe Masahiko on 2022/08/23.
//  Copyright (c) 2022 Hasebe Masahiko.
//  Released under the MIT license
//  https://opensource.org/licenses/mit-license.php
//
use crate::core::*;
//---------------------------------------------------------
//		Definition
//---------------------------------------------------------
pub trait Engine {
    fn process_a(
        &mut self, 
        _abuf: &mut msgf_afrm::AudioFrame) {}
    fn process_as(
        &mut self, 
        _in_abuf: [&mut msgf_afrm::AudioFrame;2]) {}
    fn process_c(
        &mut self,
        _cbuf: &mut msgf_cfrm::CtrlFrame) {}
    fn process_ac(
        &mut self,
        _abuf: &mut msgf_afrm::AudioFrame,
        _cbuf: &mut msgf_cfrm::CtrlFrame) {}
    fn process_as2(&mut self, 
        _in_abuf: [&mut msgf_afrm::AudioFrame;2], 
        _out_abuf: [&mut msgf_afrm::AudioFrame;2]) {}
}
//---------------------------------------------------------
//		Constants
//---------------------------------------------------------
pub const ABORT_FREQUENCY: f32 = 7000.0;    // 倍音打ち切り周波数
//---------------------------------------------------------
//		Tables
//---------------------------------------------------------
pub const PITCH_OF_A: [f32; 11] =
[
//	-3     9     21    33     45     57     69     81      93      105     117 : note number
    13.75, 27.5, 55.0, 110.0, 220.0, 440.0, 880.0, 1760.0, 3520.0, 7040.0, 14080.0  // [Hz]
];
pub const SIN_TABLE: [f32; 261] = //   index should be used by adding 2.
[
-0.049067674,   -0.024541229,
0.0,            0.024541229,    0.049067674,    0.073564564,    0.09801714,     0.122410675,    0.146730474,    0.170961889,
0.195090322,    0.21910124,     0.24298018,     0.266712757,    0.290284677,    0.31368174,     0.336889853,    0.359895037,
0.382683432,    0.405241314,    0.427555093,    0.44961133,     0.471396737,    0.492898192,    0.514102744,    0.53499762,
0.555570233,    0.575808191,    0.595699304,    0.615231591,    0.634393284,    0.653172843,    0.671558955,    0.689540545,
0.707106781,    0.724247083,    0.740951125,    0.757208847,    0.773010453,    0.788346428,    0.803207531,    0.817584813,
0.831469612,    0.844853565,    0.85772861,     0.870086991,    0.881921264,    0.893224301,    0.903989293,    0.914209756,
0.923879533,    0.932992799,    0.941544065,    0.949528181,    0.956940336,    0.963776066,    0.970031253,    0.97570213,
0.98078528,     0.985277642,    0.98917651,     0.992479535,    0.995184727,    0.997290457,    0.998795456,    0.999698819,
1.0,            0.999698819,    0.998795456,    0.997290457,    0.995184727,    0.992479535,    0.98917651,     0.985277642,
0.98078528,     0.97570213,     0.970031253,    0.963776066,    0.956940336,    0.949528181,    0.941544065,    0.932992799,
0.923879533,    0.914209756,    0.903989293,    0.893224301,    0.881921264,    0.870086991,    0.85772861,     0.844853565,
0.831469612,    0.817584813,    0.803207531,    0.788346428,    0.773010453,    0.757208847,    0.740951125,    0.724247083,
0.707106781,    0.689540545,    0.671558955,    0.653172843,    0.634393284,    0.615231591,    0.595699304,    0.575808191,
0.555570233,    0.53499762,     0.514102744,    0.492898192,    0.471396737,    0.44961133,     0.427555093,    0.405241314,
0.382683432,    0.359895037,    0.336889853,    0.31368174,     0.290284677,    0.266712757,    0.24298018,     0.21910124,
0.195090322,    0.170961889,    0.146730474,    0.122410675,    0.09801714,     0.073564564,    0.049067674,    0.024541229,
0.0,            -0.024541229,   -0.049067674,   -0.073564564,   -0.09801714,    -0.122410675,   -0.146730474,   -0.170961889,
-0.195090322,   -0.21910124,    -0.24298018,    -0.266712757,   -0.290284677,   -0.31368174,    -0.336889853,   -0.359895037,
-0.382683432,   -0.405241314,   -0.427555093,   -0.44961133,    -0.471396737,   -0.492898192,   -0.514102744,   -0.53499762,
-0.555570233,   -0.575808191,   -0.595699304,   -0.615231591,   -0.634393284,   -0.653172843,   -0.671558955,   -0.689540545,
-0.707106781,   -0.724247083,   -0.740951125,   -0.757208847,   -0.773010453,   -0.788346428,   -0.803207531,   -0.817584813,
-0.831469612,   -0.844853565,   -0.85772861,    -0.870086991,   -0.881921264,   -0.893224301,   -0.903989293,   -0.914209756,
-0.923879533,   -0.932992799,   -0.941544065,   -0.949528181,   -0.956940336,   -0.963776066,   -0.970031253,   -0.97570213,
-0.98078528,    -0.985277642,   -0.98917651,    -0.992479535,   -0.995184727,   -0.997290457,   -0.998795456,   -0.999698819,
-1.0,           -0.999698819,   -0.998795456,   -0.997290457,   -0.995184727,   -0.992479535,   -0.98917651,    -0.985277642,
-0.98078528,    -0.97570213,    -0.970031253,   -0.963776066,   -0.956940336,   -0.949528181,   -0.941544065,   -0.932992799,
-0.923879533,   -0.914209756,   -0.903989293,   -0.893224301,   -0.881921264,   -0.870086991,   -0.85772861,    -0.844853565,
-0.831469612,   -0.817584813,   -0.803207531,   -0.788346428,   -0.773010453,   -0.757208847,   -0.740951125,   -0.724247083,
-0.707106781,   -0.689540545,   -0.671558955,   -0.653172843,   -0.634393284,   -0.615231591,   -0.595699304,   -0.575808191,
-0.555570233,   -0.53499762,    -0.514102744,   -0.492898192,   -0.471396737,   -0.44961133,    -0.427555093,   -0.405241314,
-0.382683432,   -0.359895037,   -0.336889853,   -0.31368174,    -0.290284677,   -0.266712757,   -0.24298018,    -0.21910124,
-0.195090322,   -0.170961889,   -0.146730474,   -0.122410675,   -0.09801714,    -0.073564564,   -0.049067674,   -0.024541229,
0.0,            0.024541229,    0.049067674,
];

pub const VOCAL_TABLE: [f32; 261] = //   index should be used by adding 2.
[
0.048,-0.008,
0.0,  -0.056, -0.112, -0.168,-0.224,-0.28,-0.336,-0.392,
-0.448,-0.504,-0.56,-0.616,-0.672,-0.728,-0.784,-0.84,
-0.896,-0.952,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,
-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,
-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,
-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,
-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,
-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,
-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,
-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,
-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,
-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,
-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,
-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,
-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,
-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,
-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,
-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,
-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,
-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-0.975,-0.95,
-0.925,-0.9,-0.875,-0.85,-0.825,-0.8,-0.775,-0.75,
-0.725,-0.7,-0.675,-0.65,-0.625,-0.6,-0.575,-0.55,
-0.525,-0.5,-0.475,-0.45,-0.425,-0.4,-0.375,-0.35,
-0.325,-0.3,-0.275,-0.25,-0.225,-0.2,-0.175,-0.15,
-0.125,-0.1,-0.075,-0.05,-0.025,0.0,0.025,0.05,
0.075,0.1,0.125,0.15,0.175,0.2,0.225,0.25,
0.275,0.3,0.325,0.35,0.375,0.4,0.425,0.45,
0.475,0.5,0.525,0.55,0.575,0.6,0.625,0.65,
0.675,0.7,0.725,0.75,0.775,0.8,0.825,0.85,
0.875,0.9,0.925,0.95,0.975,1.0,0.944,0.888,
0.832,0.776,0.72,0.664,0.608,0.552,0.496,0.44,
0.384,0.328,0.272,0.216,0.16,0.104,0.048,-0.008,
-0.056,-0.112, -0.168,
];
// Pulse wave of duty 0.1
pub const PULSE0_1: [f32; 33] = [0.1,
    0.196726329,0.187097857,0.171678738,0.151365346,
    0.127323954,0.10091023,0.073576602,0.046774464,
    0.021858481,0.0,-0.017884212,-0.031182976,
    -0.03961817,-0.043247242,-0.042441318,-0.037841336,
    -0.030296248,-0.020788651,-0.010354017,0.0,
    0.00936792,0.017008896,0.022392879,0.025227558,
    0.025464791,0.023286976,0.019075415,0.013364133,
    0.006783667,0.0,-0.006346011,-0.011693616
];
